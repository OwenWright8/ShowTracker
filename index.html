<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Show Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #1e1e2e;
      color: #fff;
      padding: 20px;
      text-align: center;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: #2a2a3c;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    button {
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }
    .btn-primary { background: #ff7b00; color: #fff; }
    .btn-primary:hover { background: #cc6300; }
    .btn-secondary { background: #00bfa6; color: #fff; }
    .btn-secondary:hover { background: #008f7a; }
    .show-card {
      background: #33334d;
      padding: 15px;
      margin: 10px 0;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }
    .show-header {
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .show-details {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease;
    }
    .show-details.expanded {
      max-height: 1000px; /* Adjust as needed */
    }
    .season {
      background: #44445e;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      text-align: left;
    }
    .episode {
      display: inline-block;
      background: #ff7b00;
      color: #fff;
      padding: 5px 10px;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
    }
    .episode.watched {
      background: #00bfa6;
    }
    .custom-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #2a2a3c;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      text-align: center;
    }
    input[type="text"],
    input[type="number"] {
      padding: 10px;
      margin: 10px;
      width: 80%;
      border: none;
      border-radius: 5px;
      background: #3a3a4d;
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸ“º Show Tracker</h1>
    <button class="btn-primary" onclick="openShowPopup()">Add Show</button>
    <div id="shows"></div>
  </div>
  
  <!-- Show Popup -->
  <div class="custom-popup" id="showPopup">
    <h2>Enter Show Name</h2>
    <input type="text" id="popupShowName" placeholder="Show name" />
    <br />
    <button class="btn-secondary" onclick="addShow()">Add</button>
    <button class="btn-primary" onclick="closeShowPopup()">Cancel</button>
  </div>
  
  <!-- Season Popup -->
  <div class="custom-popup" id="seasonPopup">
    <h2>Enter Number of Episodes</h2>
    <input type="number" id="popupEpisodeCount" min="1" placeholder="Number of episodes" />
    <br />
    <button class="btn-secondary" onclick="confirmAddSeason()">Add</button>
    <button class="btn-primary" onclick="closeSeasonPopup()">Cancel</button>
  </div>
  
  <script>
    // Retrieve shows from localStorage or initialize as empty array
    let shows = JSON.parse(localStorage.getItem("showTracker")) || [];
    let currentShowIndexForSeason = null;
    
    function saveShows() {
      localStorage.setItem("showTracker", JSON.stringify(shows));
    }
    
    // Render the list of shows and their details
    function renderShows() {
      const showsContainer = document.getElementById("shows");
      showsContainer.innerHTML = "";
      shows.forEach((show, index) => {
        const showDiv = document.createElement("div");
        showDiv.classList.add("show-card");
        showDiv.innerHTML = `
          <div class="show-header" onclick="toggleShow(${index})">
            <h2 style="margin: 0;">${show.name}</h2>
            <div>
              <span id="arrow-${index}">â–¼</span>
              <button class="btn-primary" onclick="deleteShow(${index}); event.stopPropagation();">Delete</button>
            </div>
          </div>
          <div id="show-details-${index}" class="show-details">
            <button class="btn-secondary" onclick="openSeasonPopup(${index}); event.stopPropagation();">Add Season</button>
            <div id="seasons-${index}"></div>
          </div>
        `;
        showsContainer.appendChild(showDiv);
        renderSeasons(index);
      });
    }
    
    // Render seasons and their episodes for a given show
    function renderSeasons(showIndex) {
      const seasonsContainer = document.getElementById(`seasons-${showIndex}`);
      seasonsContainer.innerHTML = "";
      shows[showIndex].seasons.forEach((season, sIndex) => {
        const seasonDiv = document.createElement("div");
        seasonDiv.classList.add("season");
        seasonDiv.innerHTML = `
          <strong>Season ${sIndex + 1}</strong>
          <button class="btn-primary" onclick="deleteSeason(${showIndex}, ${sIndex}); event.stopPropagation();">Delete Season</button>
          <div id="episodes-${showIndex}-${sIndex}"></div>
        `;
        seasonsContainer.appendChild(seasonDiv);
        renderEpisodes(showIndex, sIndex);
      });
    }
    
    // Render episodes for a given season
    function renderEpisodes(showIndex, seasonIndex) {
      const episodesContainer = document.getElementById(`episodes-${showIndex}-${seasonIndex}`);
      episodesContainer.innerHTML = "";
      shows[showIndex].seasons[seasonIndex].episodes.forEach((episode, eIndex) => {
        const episodeSpan = document.createElement("span");
        episodeSpan.classList.add("episode");
        if (episode.watched) episodeSpan.classList.add("watched");
        episodeSpan.innerText = `Ep ${eIndex + 1}`;
        episodeSpan.onclick = function(e) {
          e.stopPropagation();
          toggleEpisode(showIndex, seasonIndex, eIndex);
        }
        episodesContainer.appendChild(episodeSpan);
      });
    }
    
    // Toggle the watched status of an episode
    function toggleEpisode(showIndex, seasonIndex, episodeIndex) {
      shows[showIndex].seasons[seasonIndex].episodes[episodeIndex].watched = 
        !shows[showIndex].seasons[seasonIndex].episodes[episodeIndex].watched;
      saveShows();
      renderShows();
    }
    
    // Toggle the expansion of a show's details with animation
    function toggleShow(index) {
      const details = document.getElementById(`show-details-${index}`);
      const arrow = document.getElementById(`arrow-${index}`);
      if (details.classList.contains("expanded")) {
        details.classList.remove("expanded");
        arrow.innerText = "â–¼";
      } else {
        details.classList.add("expanded");
        arrow.innerText = "â–²";
      }
    }
    
    // Show Popup functions for adding a show
    function openShowPopup() {
      document.getElementById("showPopup").style.display = "block";
    }
    function closeShowPopup() {
      document.getElementById("showPopup").style.display = "none";
    }
    function addShow() {
      const name = document.getElementById("popupShowName").value.trim();
      if (name) {
        shows.push({ name: name, seasons: [] });
        saveShows();
        renderShows();
        closeShowPopup();
        document.getElementById("popupShowName").value = "";
      }
    }
    
    // Season Popup functions for adding a season
    function openSeasonPopup(showIndex) {
      currentShowIndexForSeason = showIndex;
      document.getElementById("seasonPopup").style.display = "block";
    }
    function closeSeasonPopup() {
      document.getElementById("seasonPopup").style.display = "none";
    }
    function confirmAddSeason() {
      const count = parseInt(document.getElementById("popupEpisodeCount").value, 10);
      if (!isNaN(count) && count > 0 && currentShowIndexForSeason !== null) {
        const episodes = Array.from({ length: count }, () => ({ watched: false }));
        shows[currentShowIndexForSeason].seasons.push({ episodes: episodes });
        saveShows();
        renderShows();
        closeSeasonPopup();
        document.getElementById("popupEpisodeCount").value = "";
      }
    }
    
    // Delete functions for shows and seasons
    function deleteShow(showIndex) {
      if (confirm("Are you sure you want to delete this show?")) {
        shows.splice(showIndex, 1);
        saveShows();
        renderShows();
      }
    }
    function deleteSeason(showIndex, seasonIndex) {
      if (confirm("Are you sure you want to delete this season?")) {
        shows[showIndex].seasons.splice(seasonIndex, 1);
        saveShows();
        renderShows();
      }
    }
    
    renderShows();
  </script>
</body>
</html>
